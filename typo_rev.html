<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">

    <link rel="stylesheet" type="text/css" href="style_.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="app.js"></script>

    <!-- SPLITTING -->
    <script type="text/javascript" src="https://unpkg.com/splitting@1.0.6/dist/splitting.min.js"></script>
    <!-- GSAP -->
	  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.0/gsap.min.js"></script>
	  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.0/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.0/MotionPathPlugin.min.js"></script>
    <script src="jquery-resizeEnd.min.js"></script>


    <title>Moving Typography At Scroll</title>

  </head>
  <body>

    <div class="container">

      <div id="s1" class="section introduction">

        <svg class="svg" id="svg_works" data-name="svg works" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1004.65 768">
          <title>Senza titolo-1</title>
          <path class="word_path" id="_w" d="M346.79,332.1H358l11.12,42.19h.16l12.65-42.19h10.55l12.41,42.19h.17l11.36-42.19h10.87l-16.8,57.44h-9.9l-13.46-43.08H387l-13.47,43.08h-9.9Z" transform="translate(-0.5 -3)" style="fill: white"/>
          <path class="word_path" id="_o" d="M430.36,360.66a32.12,32.12,0,0,1,2.31-12.45,27.37,27.37,0,0,1,6.41-9.46,28.47,28.47,0,0,1,9.73-6,34.76,34.76,0,0,1,12.3-2.11,35.34,35.34,0,0,1,12.41,2.11,28.83,28.83,0,0,1,9.81,6,27.21,27.21,0,0,1,6.46,9.46,32.12,32.12,0,0,1,2.31,12.45A31.73,31.73,0,0,1,489.79,373a28.33,28.33,0,0,1-6.46,9.57,29.25,29.25,0,0,1-9.81,6.25A33.64,33.64,0,0,1,461.11,391a33.09,33.09,0,0,1-12.3-2.23,28.9,28.9,0,0,1-9.73-6.25,28.5,28.5,0,0,1-6.41-9.57A31.73,31.73,0,0,1,430.36,360.66Zm11.11,0a24.3,24.3,0,0,0,1.42,8.48,19.72,19.72,0,0,0,4.06,6.69,18.57,18.57,0,0,0,6.24,4.42,19.66,19.66,0,0,0,8,1.58,19.88,19.88,0,0,0,8-1.58,18.57,18.57,0,0,0,6.29-4.42,19.7,19.7,0,0,0,4.05-6.69,24.3,24.3,0,0,0,1.42-8.48,23.45,23.45,0,0,0-1.42-8.28,20.15,20.15,0,0,0-4-6.65,18.63,18.63,0,0,0-6.25-4.46,19.77,19.77,0,0,0-8.11-1.62,19.45,19.45,0,0,0-8.07,1.62,18.67,18.67,0,0,0-6.21,4.46,20.34,20.34,0,0,0-4,6.65A23.45,23.45,0,0,0,441.47,360.66Z" transform="translate(-0.5 -3)" style="fill: white"/>
          <path class="word_path" id="_r" d="M502,332.1h20a35.79,35.79,0,0,1,7.86.85,20.34,20.34,0,0,1,6.78,2.8,14.54,14.54,0,0,1,4.74,5.11,15.48,15.48,0,0,1,1.79,7.71,14.67,14.67,0,0,1-3.53,10.18,17.8,17.8,0,0,1-9.61,5.32l15.33,25.47H533L519.68,365.2h-7.46v24.34H502Zm18.58,24.75a29.46,29.46,0,0,0,4.38-.33,12.56,12.56,0,0,0,3.93-1.22,7.66,7.66,0,0,0,2.88-2.55,7.38,7.38,0,0,0,1.14-4.26,6.54,6.54,0,0,0-1.06-3.86,7.86,7.86,0,0,0-2.67-2.39,11.27,11.27,0,0,0-3.7-1.21,25.5,25.5,0,0,0-4-.33h-9.25v16.15Z" transform="translate(-0.5 -3)" style="fill: white"/>
          <path class="word_path" id="_k" d="M553,332.1h10.22v24.82h.24l24-24.82H601.3l-26.85,26.53,28.63,30.91H588.72l-25.23-28.8h-.24v28.8H553Z" transform="translate(-0.5 -3)" style="fill: white"/>
          <path class="word_path" id="_s" d="M638.22,344.11a12.43,12.43,0,0,0-4.59-3.53,13.61,13.61,0,0,0-6-1.42,15,15,0,0,0-3.57.44,11.1,11.1,0,0,0-3.25,1.38,7.74,7.74,0,0,0-2.39,2.44,6.71,6.71,0,0,0-.93,3.61,6.52,6.52,0,0,0,.81,3.33,7.33,7.33,0,0,0,2.23,2.35,15,15,0,0,0,3.45,1.7c1.35.49,2.84,1,4.46,1.46,1.84.6,3.74,1.27,5.72,2a22.42,22.42,0,0,1,5.43,3,14.81,14.81,0,0,1,4.06,4.71,14.25,14.25,0,0,1,1.58,7.05,18,18,0,0,1-1.7,8.08,16.68,16.68,0,0,1-4.54,5.72,19.43,19.43,0,0,1-6.66,3.4,27.88,27.88,0,0,1-8,1.14,30.13,30.13,0,0,1-11-2.07,21.17,21.17,0,0,1-8.76-6.12l7.3-6.82a14.67,14.67,0,0,0,5.64,4.63,15.1,15.1,0,0,0,10.58,1.26,9.63,9.63,0,0,0,3.37-1.51,8.52,8.52,0,0,0,2.44-2.63,7.68,7.68,0,0,0,.93-3.94,6.43,6.43,0,0,0-1.06-3.77,9.49,9.49,0,0,0-2.83-2.6,20.67,20.67,0,0,0-4.22-1.9l-5.12-1.71a52.05,52.05,0,0,1-5.19-1.94,17.17,17.17,0,0,1-4.66-3,14.38,14.38,0,0,1-3.37-4.58,15.6,15.6,0,0,1-1.3-6.77A14.81,14.81,0,0,1,609,340a16.08,16.08,0,0,1,4.78-5.23,21.43,21.43,0,0,1,6.74-3.09,29.62,29.62,0,0,1,7.66-1,27.54,27.54,0,0,1,8.89,1.54,21.73,21.73,0,0,1,7.83,4.63Z" transform="translate(-0.5 -3)" style="fill: white"/>
          <path id="w_" d="M400.5,360.5C454.91,360.5,454,273,435,217S371.83,82.9,247,92c-96,7-125.43,67.93-109,96,24,41,95.46,52.31,149,5,43-38,31.65-112.93-22-130-66-21-83,70-175,44S1,58,1,58" transform="translate(-0.5 -3)" style="fill: none"/>
          <path id="o_" d="M463,360c28,0,21.63,108.29-9,191-20,54-68,94-119,102-101.8,16-156-70-92-129s220-58,358-3c184.92,73.7,155,192,119,250" transform="translate(-0.5 -3)" style="fill: none"/>
          <path id="r_" d="M514.5,359.5C537,359.5,539,483,593,498s106,6,138-18c33.65-25.24,89-143,27-183S648,426,844,539c66,38,165.6,108.17,161,156-5,52-76,75-116,74" transform="translate(-0.5 -3)" style="fill: none"/>
          <path id="k_" d="M563,361c146,0-8-184,101-204s90,112,222,96c97.23-11.79,117-103,72-250" transform="translate(-0.5 -3)" style="fill: none"/>
          <path id="s_" d="M632.5,360.5C715.5,360.5,823,202,905,315c51.64,71.16-38.28,419.06-343,362C311,630,414.5,321.5.5,356.5" transform="translate(-0.5 -3)" style="fill: none"/>
        </svg>


      </div>

      <div class="introduction_placeholder">

      </div>
      <div class="gallery_header">
        <h4>Titolo Gallery</h4>
      </div>


      <div id="s2" class="section gallery">
        <div class="gallery_item">

          <div class="gallery_item_header">
            <h4>Titolo 1</h4>
          </div>
          <div class="gallery_item_image">
            <img src="https://loremflickr.com/360/640" alt="">
          </div>

        </div>
        <div class="gallery_item">

          <div class="gallery_item_header">
            <h4>Titolo 2</h4>
          </div>
          <div class="gallery_item_image">
            <img src="https://loremflickr.com/360/640" alt="">
          </div>

        </div>
        <div class="gallery_item">

          <div class="gallery_item_header">
            <h4>Titolo 3</h4>
          </div>
          <div class="gallery_item_image">
            <img src="https://loremflickr.com/360/640" alt="">
          </div>

        </div>
        <div class="gallery_item">

          <div class="gallery_item_header">
            <h4>Titolo 4</h4>
          </div>
          <div class="gallery_item_image">
            <img src="https://loremflickr.com/360/640" alt="">
          </div>

        </div>
      </div>
      <div id="s3" class="section gallery_index">
        <div class="index_filters">

          <h5>Titolo section</h5>
            <h6>Filtro</h6>
            <h6>Filtro</h6>
            <h6>Filtro</h6>
          <h5>Titolo section</h5>
            <h6>Filtro</h6>
            <h6>Filtro</h6>
          <h5>Titolo section</h5>
            <h6>Filtro</h6>
            <h6>Filtro</h6>
            <h6>Filtro</h6>

        </div>
        <div class="index_list">

        </div>
      </div>


    </div> <!-- close .container -->

    <div class="footer">

    </div>



    <script type="text/javascript">

      // ---------------------------------------------
      // ON LOAD
      window.addEventListener('DOMContentLoaded', (event) => {
        animate();
        initScrollTriggers();
        console.log('[page is loaded] ready!');
      });

      // ON RESIZE
      jQuery(function($) {
        $(window).on("resizeEnd", function (event) {
          initScrollTriggers();
          console.log('[end] window resize');
        });
      });
      // ---------------------------------------------



      // ---------------------------------------------
      // CAPPELLO
      const letters_ = ["#_w","#_o","#_r","#_k", "#_s"];
      const paths_ = ["#w_","#o_","#r_","#k_", "#s_"];
      var dur=1;
      function animate(){

        ScrollTrigger.matchMedia({
          "(min-width: 800px)": function(){
            let new_tl = gsap.timeline({paused:true,
              scrollTrigger: {
                trigger: ".introduction",
                markers:true,
                pin: true,
                start: "top top",
                end: "+="+window.innerHeight,
                scrub: 1,
                onLeave: () => fade_out(),
                onEnterBack: () => fade_in(),
              }
            });

            letters_.forEach((letter, i) => {
              new_tl.to(
                letter,
                {
                  duration:dur,
                  scale:4,
                  motionPath:{
                    path: paths_[i],
                    align: paths_[i],
                    autoRotate: true,
                    alignOrigin: [0.5, 0.5]
                  }
                }, '<');
            });
          }
        })
      }

      function fade_out(){}
      function fade_in(){}
      // ---------------------------------------------


      // ---------------------------------------------
      // SCROLL TRIGGERS
      var scrolltriggers = [];
      function initScrollTriggers(){
        if (scrolltriggers.length > 0) {
          scrolltriggers.forEach((item, i) => {
            ScrollTrigger.getById(item).kill(true);
          });
          scrolltriggers = [];
        }

        let dura = document.getElementById('s2').offsetHeight;
        let opening_sect_hgt = document.getElementById('s1').offsetHeight;

       ScrollTrigger.create({
          id: 'st_header',
          trigger: ".gallery_header",
          start: "top top",
          end:opening_sect_hgt + dura,
          pin: true,
          markers:true,
          pinSpacing: false,
          invalidateOnRefresh: true
        });
        scrolltriggers.push('st_header');



        let els = document.getElementsByClassName("gallery_item_header");
        let items = document.getElementsByClassName("gallery_item");


        for(var i = 0; i < els.length; i++)
        {
          let temp_sect_hgt = window.pageYOffset + items[i].getBoundingClientRect().top;

          ScrollTrigger.create({
            id: 'st_gallery_item_'+i,
            trigger: els[i],
            start: "top 30px",
            end: opening_sect_hgt+temp_sect_hgt,
            pin: true,
            markers:true,
            pinSpacing: false
          });

          scrolltriggers.push('st_gallery_item_'+i);
        }
      }
      // ---------------------------------------------






    </script>



  </body>
</html>
